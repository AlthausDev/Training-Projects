@page "/Todo"
<PageTitle>ToDo List!</PageTitle>

@inject HttpClient Http
@inject IJSRuntime JS
@using BlazorWebPage.Shared
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Popups
@using System.Diagnostics


<Modal @ref="modal" Title="Modal title" Size="ModalSize.ExtraLarge">
    <BodyTemplate>
        <div id="formDiv">
            <label id="formLabel">
                Nombre
                <input type="text" id="formTextBox" size="100%" Placeholder='Campo de texto de prueba'
                       @bind="@nuevaTarea.Nombre" />
            </label>
        </div>

        <div id="formDiv">
            <label id="formLabel">
                Descripción
                <input type="text" id="formTextBox" size="100%" Placeholder='Campo de texto de prueba'
                       @bind="@nuevaTarea.Descripcion" />
            </label>
        </div>

        <div id="formDiv">
            <input type="checkbox" id="finalizadoCheckBox" name="Finalizado" value="@nuevaTarea.Finalizado" />
            <label for="finalizadoCheckBox">Finalizado</label>
        </div>
    </BodyTemplate>
    <FooterTemplate>
        <div id="FormButtons">
            <button class="btn btn-success" @onclick="execTarea" disabled="@IsDisabled">Aceptar</button>
            <button class="btn btn-danger" @onclick="HideModal">Cancelar</button>
        </div>
    </FooterTemplate>
</Modal>

@* <nav id="menu">
    <div id="topButtons">
        <div>
            <button class="btn btn-success" @onclick="(() => OnClickShowModal(Accion.Crear))">Nueva Tarea</button>
        </div>
        <div>
            <button class="btn btn-danger" @onclick="@Delete" disabled="@IsDisabledEdit">Borrar</button>
        </div>
        <div>
            <button class="btn btn-warning" @onclick="(() => OnClickShowModal(Accion.Editar))" disabled="@IsDisabledEdit">Editar</button>
        </div>

    </div>
    https://demos.blazorbootstrap.com/autocomplete
     <div id="SearchTextBox">
        <AutoComplete @bind-Value="@nuevaTarea.Nombre"
                      TItem="Tarea"
                      DataProvider="TareasDataProvider"
                      PropertyName="Nombre"
                      Placeholder="Buscar tarea"
                      OnChanged="(Tarea tarea) => OnAutoCompleteChanged(tarea)"
                      Size="AutoCompleteSize.Default" />
    </div>
</nav> *@

<nav id="menu">
    <div id="topButtons">
       
            
       

    </div>
    @*https://demos.blazorbootstrap.com/autocomplete*@
    
</nav>


<nav class="navbar navbar-inverse">
    <div class="container-fluid">        
        <ul class="nav navbar-nav">           
            <li><button class="btn btn-success" @onclick="(() => OnClickShowModal(Accion.Crear))">Nueva Tarea</button></li>
            <li><button class="btn btn-danger" @onclick="@Delete" disabled="@IsDisabledEdit">Borrar</button></li>
            <li><button class="btn btn-warning" @onclick="(() => OnClickShowModal(Accion.Editar))" disabled="@IsDisabledEdit">Editar</button></li>  
        </ul>
            <div id="SearchTextBox">
                <AutoComplete @bind-Value="@nuevaTarea.Nombre"
                              TItem="Tarea"
                              DataProvider="TareasDataProvider"
                              PropertyName="Nombre"
                              Placeholder="Buscar tarea"
                              OnChanged="(Tarea tarea) => OnAutoCompleteChanged(tarea)"
                              Size="AutoCompleteSize.Default" />
        </div>
        <ul class="nav navbar-nav navbar-right">
            <div id="scrollBtnContainer">
                <button id="scrollBtnDown" onclick="bottomFuction()" title="Scroll to Bottom">
                    <i class="oi oi-chevron-bottom"></i>
                </button>
            </div>
        </ul>
    </div>
</nav>

<table class="table">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Descripcion</th>
            <th>Finalizado</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var tarea in tareas)
        {
            <tr class="@GetRowClass(tarea)" id="fila" @onclick="(() => selectTarea(tarea))">
                <td>@tarea.Nombre</td>
                <td>@tarea.Descripcion</td>
                <td>@(tarea.Finalizado ? Finalizado.Si : Finalizado.No)</td>
            </tr>
        }
    </tbody>
</table>

<div id="scrollBtnContainer">
    <button id="scrollBtnDown" onclick="bottomFuction()" title="Scroll to Bottom">
        <i class="oi oi-chevron-bottom"></i>
    </button>
</div>
<div id="scrollBtnContainertop">
    <button id="scrollBtn" onclick="topFunction()" title="Scroll to Top">
        <i class="oi oi-chevron-top"></i>
    </button>
</div>

<section id="bottom" />
<script>
    let mybutton = document.getElementById("scrollBtn");
    let mybuttonTop = document.getElementById("scrollBtnDown");

    window.onscroll = function () { scrollFunction() };

    function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            mybutton.style.display = "block";
        } else {
            mybutton.style.display = "none";
        }
    }

    window.addEventListener('scroll', (e) => {
        const body = document.body;
        const parent = body.parentElement;
        const pixelsFromBottom = body.scrollHeight - parent.clientHeight - 50;

        if (parent.scrollTop < pixelsFromBottom) {
            mybuttonTop.style.display = "block";
        } else {
            mybuttonTop.style.display = "none";
        }
    });

    function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }

    function bottomFuction() {
        document.getElementById('bottom').scrollIntoView({ behavior: 'smooth' });
    }

    // function searchFuction() {

    //     var w = $(window);
    //     var row = $('#tableid').find('tr').eq(fila);

    //     // var row = table.find('tr')
    //     //     .removeClass('active')
    //     //     .eq(+$('#fila').val())
    //     //     .addClass('active');

    //     if (row.length) {
    //         $('html,body').animate({ scrollTop: row.offset().top - (w.height() / 2) }, 1000);
    //     }
    // }

    // function CalculatePositionOfTR() {
    //     return $('tr:eq(' + i + ')').offset().top;
    // }

    // function searchFuction(i) {
    //     var position = CalculatePositionOfTD(i);
    //     var timer = setTimeout(function () {
    //         ScrollDownALittle(position);
    //         if (CenterOfVerticalWindowPosition > position)
    //             clearInterval(timer);
    //     }, 100);
    // }
</script>


<style>

  /*   #SearchTextBox {
        width: 100%;
        
    }

        #SearchTextBox AutoComplete {
            width: 100%;
        } */

    #menu{
        display: inline-flex;
        position: fixed;     
        z-index: 99;      
        text-align: center;
    }

    #menu div{
    }

    #topButtons {
         display: flex;
       
    }

        #topButtons div {
            display: block;
            text-align: center;
            margin: 5%;
            box-shadow: 1px 1px 22px 4px rgba(66,52,66,0.69);
            border-radius: 8px;
        }

        #topButtons button {
            border-radius: 8px;
            border: 1px solid white;
        }


    *,
    *:before,
    *:after {
        box-sizing: border-box;
    }

    input[type="checkbox"] {
        appearance: none;
        background-color: #fff;
        margin: 0;
        font: inherit;
        width: 1.15em;
        height: 1.15em;
        border: 0.15em solid rebeccapurple;
        border-radius: 0.18em;
        transform: translateY(-0.075em);
        display: grid;
        place-content: center;
    }

        input[type="checkbox"]::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em rebeccapurple;
            transform-origin: bottom left;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }

        input[type="checkbox"]:checked::before {
            transform: scale(1);
        }

        input[type="checkbox"]:hover {
            border: 0.18em solid rebeccapurple;
            border-radius: 0.20em;
            box-shadow: 0px 0px 12px 4px rgba(153,102,204,1);
        }

    input[type="text"] {
    }

    #scrollBtn, #scrollBtnDown {
        position: fixed;
        right: 2%;
        z-index: 999;
        border: 1px solid white;
        background: linear-gradient(145deg, rgba(7,54,141,1) 0%, rgba(42,33,121,1) 33%, rgba(81,9,99,1) 70%, rgba(81,9,99,1) 100%);
        color: white;
        cursor: pointer;
        padding: 10px 15px 10px 15px;
        border-radius: 12px;
        font-size: 18px;
        box-shadow: 1px 1px 20px 4px rgba(107,11,131,1);
    }

    #scrollBtn {
        display: none;
        bottom: 5%;
    }

    #scrollBtnDown {
        display: block;
        top: 7%;
    }

        #scrollBtn:hover, #scrollBtnDown:hover {
            background: linear-gradient(290deg, rgba(9,72,190,1) 0%, rgba(55,43,162,1) 33%, rgba(107,11,131,1) 70%, rgba(107,11,131,1) 100%);
        }


    body {
        background: linear-gradient(160deg, rgba(27,58,117,0.7624299719887955) 0%, rgba(80,21,94,0.7344187675070029) 47%, rgba(239,222,246,1) 100%);
    }

    /*   #topButtons {
                    display: inline-flex;
                    position: fixed;
                    text-align: center;
                    width: 100%;
                } */

    
    #formDiv {
        display: flex;
        flex-direction: row;
        margin: 2% 5% 5%;
    }

        #formDiv label {
            display: inline-block;
            flex: 1;
            flex-basis: 200px;
            font-size: 14px;
        }

    #formLabel {
        margin-top: 28px;
    }

    #FormButtons {
        display: flex;
        margin: 5%;
        text-align: right;
    }

        #FormButtons button {
            box-shadow: 1px 1px 22px 4px rgba(66,52,66,0.69);
            margin-right: 2%;
            border-radius: 8px;
            border: 1px solid white;
        }

    .btn {
        width: 165px;
    }

    .e-float-input.e-control-wrapper textarea:not(:valid), .e-float-input.e-control-wrapper textarea:valid,
    .e-input-group textarea:not(:valid), .e-input-group textarea:valid {
        min-height: 250px;
    }

    #finalizadoCheckBox {
        margin-right: 15px;
    }

    .table {
        margin-top: 80px;
    }

    .table, th, td {
        border: 1px solid black;
    }

        .table th {
            background-color: #E0E0E0;
        }

    tr:not(.selected-row) {
        cursor: pointer;
        background-color: white;
    }

    tr:hover:not(.selected-row) {
        background-color: lightcyan;
    }

    .selected-row {
        background-color: #9ed9e0;
    }
</style>

